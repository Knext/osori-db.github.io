<div class="header-dropdown pl-8">
    <div class="language-div">
        <button class="change-language-btn shared-language-btn" onclick="showLanguageOptions()">
            <i class="fa-solid fa-globe pr-2"></i>
            {% if site.lang == site.languages[0] %}
            {{ site.languageNames.en }}
            {% else %}
            {{ site.languageNames.ko }}
            {% endif %}
        </button>
        <i class="change-language-btn fa-solid fa-chevron-down pl-3 chevron-icon" onclick="showLanguageOptions()"></i>
    </div>
    <div class="header-dropdown-content" id="language-dropdown">
        {% if site.lang == site.languages[0] %}
        <a id="kor-lang-link"><i class="fa-solid fa-earth-asia mr-1"></i> {{ site.languageNames.ko }}</a>
        {% else %}
        <a id="eng-lang-link"><i class="fa-solid fa-earth-americas mr-1"></i> {{ site.languageNames.en }}</a>
        {% endif %}
    </div>
</div>

<script>
    const OCCURRENCE = 3;
    var currentURL = window.location.href;

    if (currentURL.includes('/ko')) {
        var anchor = document.getElementById('eng-lang-link');
        var index = getIndex(currentURL, '/', OCCURRENCE);

        var firstSubstring = currentURL.substring(0, index);
        var secondSubstring = currentURL.substring(index + 4);

        anchor.href = firstSubstring + '/' + secondSubstring;
    } else {
        var anchor = document.getElementById('kor-lang-link');
        var index = getIndex(currentURL, '/', OCCURRENCE);

        var firstSubstring = currentURL.substring(0, index);
        var secondSubstring = currentURL.substring(index + 1);

        anchor.href = firstSubstring + '/ko/' + secondSubstring;
    }

    function getIndex(str, searchKey, occurrence) {
        return str.split(searchKey, occurrence).join(searchKey).length;
    }

    function showLanguageOptions() {
        document.getElementById("language-dropdown").classList.toggle("show");
    }
    window.onclick = function (e) {
        if (!e.target.matches('.change-language-btn')) {
            var languageDropdown = document.getElementById("language-dropdown");
            if (languageDropdown.classList.contains('show')) {
                languageDropdown.classList.remove('show');
            }
        }
    }
</script>